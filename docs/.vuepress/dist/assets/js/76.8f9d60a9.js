(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{556:function(a,t,s){"use strict";s.r(t);var e=s(20),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("有这么一道不太难的面试题，做出这道题应该是轻轻松松，但是想要了解这道题本身考察的知识点，就需要仔细的研究一下：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v("let x = 1;\nfunction A(y){\n    let x = 2;\n    function B(z){\n        console.log(x+y+z);\n    }\n    return B;\n}\nlet C = A(2);\nC(3);\n")])])]),s("p",[a._v("按照闭包的概念，上面的例子中，函数套函数，子级函数里面用了父级函数的变量，这种情况就属于闭包")]),a._v(" "),s("p",[a._v("打印结果是7")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v("1、let C = A(2)调用的是A这个函数，传参是2，所以y是2,返回值是B这个函数，这个地方没有被调用\n2、x在函数内被重新赋值，所以x是2\n3、C(3)调用的是A(2)的返回值也就是B函数，参数是3，所以z是3\n4、2+2+3=7\n")])])]),s("p",[a._v("如果这么理解就太简单了，就借这道题，彻底的理解一下闭包的概念，画图理解一下这个题")]),a._v(" "),s("h2",{attrs:{id:"一、创建一个函数发生了什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、创建一个函数发生了什么"}},[a._v("#")]),a._v(" 一、创建一个函数发生了什么")]),a._v(" "),s("h4",{attrs:{id:"_1、首先会开辟一个堆内存-然后形成一个16进制的内存地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、首先会开辟一个堆内存-然后形成一个16进制的内存地址"}},[a._v("#")]),a._v(" 1、首先会开辟一个堆内存，然后形成一个16进制的内存地址")]),a._v(" "),s("h4",{attrs:{id:"_2、声明当前函数的作用域-在哪儿声明的-作用域就是谁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、声明当前函数的作用域-在哪儿声明的-作用域就是谁"}},[a._v("#")]),a._v(" 2、声明当前函数的作用域（在哪儿声明的，作用域就是谁）")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/19824658-c3703c02b6871242?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image"}})]),a._v(" "),s("h4",{attrs:{id:"_3、把函数体中的代码当做-字符串-存储在堆内存中-创建一个函数-存储的是一堆字符串-所以函数只要不执行-函数其实没啥意义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、把函数体中的代码当做-字符串-存储在堆内存中-创建一个函数-存储的是一堆字符串-所以函数只要不执行-函数其实没啥意义"}},[a._v("#")]),a._v(" 3、把函数体中的代码当做“字符串”存储在堆内存中（创建一个函数，存储的是一堆字符串，所以函数只要不执行，函数其实没啥意义）")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/19824658-b4a27725e21f2bea?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image"}})]),a._v(" "),s("h4",{attrs:{id:"_4、把函数堆的地址类似于对象一样-放置在栈中供变量调用-函数名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、把函数堆的地址类似于对象一样-放置在栈中供变量调用-函数名"}},[a._v("#")]),a._v(" 4、把函数堆的地址类似于对象一样，放置在栈中供变量调用(函数名)")]),a._v(" "),s("h2",{attrs:{id:"二、执行一个函数会发生什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、执行一个函数会发生什么"}},[a._v("#")]),a._v(" 二、执行一个函数会发生什么")]),a._v(" "),s("h4",{attrs:{id:"_1、会形成一个全新的私有上下文-代号ec-xx-目的是供函数体中的代码执行-然后进栈执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、会形成一个全新的私有上下文-代号ec-xx-目的是供函数体中的代码执行-然后进栈执行"}},[a._v("#")]),a._v(" 1、会形成一个全新的私有上下文，代号EC(xx)（目的是供函数体中的代码执行），然后进栈执行")]),a._v(" "),s("h4",{attrs:{id:"_2、在私有上下文中有一个存放私有变量的变量对象-代号oa"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、在私有上下文中有一个存放私有变量的变量对象-代号oa"}},[a._v("#")]),a._v(" 2、在私有上下文中有一个存放私有变量的变量对象，代号OA")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/19824658-ba038900cc1b6dc6?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image"}})]),a._v(" "),s("h4",{attrs:{id:"_3、3-在代码执行之前要做的事情很多"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、3-在代码执行之前要做的事情很多"}},[a._v("#")]),a._v(" 3、3.在代码执行之前要做的事情很多：")]),a._v(" "),s("ul",[s("li",[s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v(" 初始化它的作用域链 <自己上的上下文,函数的作用域>\n")])])])]),a._v(" "),s("li",[s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v(" 初始化THIS （箭头函数没有THIS）\n")])])])]),a._v(" "),s("li",[s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v(" 初始化ARGUMENTS实参集合（箭头函数没有ARGUMENTS）\n")])])])]),a._v(" "),s("li",[s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v(" 形参赋值（形参变量是函数的私有变量，需要存储在AO中的）\n")])])])]),a._v(" "),s("li",[s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v(" 变量提升（在私有上下文中声明的变量都是私有变量）\n")])])])])]),a._v(" "),s("h4",{attrs:{id:"_4、代码执行-把之前在函数堆中存储的字符串-拿过来在上下文中依次执行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、代码执行-把之前在函数堆中存储的字符串-拿过来在上下文中依次执行"}},[a._v("#")]),a._v(" 4、代码执行（把之前在函数堆中存储的字符串，拿过来在上下文中依次执行）")]),a._v(" "),s("p",[a._v("这个时候function B不会执行，而是会继续开辟一个堆内存，形成一个地址，供变量调用")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/19824658-ea0f30df910f7e96?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image"}}),a._v("\nfunction B执行，因为x和y在函数B不是私有变量")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/19824658-7db1d9c1565ae03d?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image"}})]),a._v(" "),s("p",[a._v("作用域链查找机制：在代码执行中，遇到一个变量，我们首先看一下是否为自己的私有变量，如果是自己的私有变量，接下来所有操作都是操作私有的（和外界没有直接的联系）；如果不是自己私有的，则按照scope-chain，向上级上下文中查找（如果是上级私有的，接下来的操作都是操作上级上下文中的变量）一直找，直到找到EC(G)为止")]),a._v(" "),s("h3",{attrs:{id:"_5、根据实际的情况确定当前上下文是否出栈释放"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5、根据实际的情况确定当前上下文是否出栈释放"}},[a._v("#")]),a._v(" 5、根据实际的情况确定当前上下文是否出栈释放")]),a._v(" "),s("p",[a._v("为了保证栈内存的大小（内存优化），一般情况下，如果当前函数执行产生的上下文，在进栈且代码执行完成后，会把次上下文移除栈（上下文释放到了：之前在上下文中存储的私有的变量等信息也就有跟着释放了）")]),a._v(" "),s("p",[a._v("=>全局上下文是在打开页面生成的，也需要在关闭页面的时候释放掉(只有页面关闭才会被释放掉)")]),a._v(" "),s("h3",{attrs:{id:"特殊情况"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特殊情况"}},[a._v("#")]),a._v(" 特殊情况：")]),a._v(" "),s("ul",[s("li",[a._v("只要当前上下文中的某些内容，被上下文以外的东西占用，那么当前上下文是不能被释放的（上下文中存储的变量等信息也保留下来了）")]),a._v(" "),s("li"),a._v(" "),s("li",[a._v("=>这种情况就是大家认为的闭包")])]),a._v(" "),s("h2",{attrs:{id:"总结-啥是闭包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结-啥是闭包"}},[a._v("#")]),a._v(" 总结：啥是闭包？")]),a._v(" "),s("p",[a._v("它是函数运行时候所产生的机制，函数执行会形成一个全新的私有上下文，可以保护里面的私有变量和外界互不干扰（保护机制），但是大家所认为的闭包，需要当前上下文不能被出栈释放，这样私有变量及它的值也不会被释放掉（保存机制）；")]),a._v(" "),s("h2",{attrs:{id:"闭包干啥用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#闭包干啥用"}},[a._v("#")]),a._v(" 闭包干啥用？")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v("闭包的作用：保护/保存\n")])])]),s("h2",{attrs:{id:"最后再来几道闭包的面试题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最后再来几道闭包的面试题"}},[a._v("#")]),a._v(" 最后再来几道闭包的面试题")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v("let a=0,\n\tb=0;\nfunction A(a){\n\tA=function(b){\n\t\talert(a+b++);\n\t};\n\talert(a++);\n}\nA(1);\nA(2);\n\n// 1  4\n\nlet x = 5;\nfunction fn(x) {\n\treturn function(y) {\n\t\tconsole.log(y + (++x));\n\t}\n}\nlet f = fn(6);\nf(7);\nfn(8)(9);\nf(10);\n\n// 14 18 18 5\n")])])]),s("p",[a._v("公众号地址，欢迎关注")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/19824658-5bcf990bd67dcae5?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);